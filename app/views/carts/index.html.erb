<div class="container">
<h1>Carts</h1>

<table>
  <thead>
    <tr>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% total = 0 %>
      <% @carts.where(user_id: current_user.id).each do |cart| %>
        <div class="container-fluid">
          <div class="row shadow-sm bg-white justify-content-center rounded-sm pb-3 pt-3 pl-3 mb-3 text-dark border pr-0 m-0">
            <div class="col-12 d-flex justify-content-between align-items-center text-black-50 m-0 p-0">
              <%= Item.find(cart.item_id.to_i).name %>
              <%= Item.find(cart.item_id.to_i).price %>$
              <%= link_to "", user_cart_path(current_user.id, cart.id), method: "delete", :class => "fas fa-times fa-2x spec mr-3" %>
            </div>
            </div>
          </div>
        <% total += Item.find(cart.item_id).price %>
    <% end %>

    <div class="col-12 d-flex justify-content-between align-items-center text-black-50 m-0 p-0">
      <h2>Total <%= total %>$</h2>
    </div>

    <%= form_tag orders_path, method: "post" do %>

      <article>

        <% if flash[:error].present? %>
          <div id="error_explanation">
            <p><%= flash[:error] %></p>
          </div>
        <% end %>
        <label class="amount">
          <span>Amount: <%= total.to_f %>$</span>
        </label>
      </article>



    <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
    data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
    data-description="Paiement Bryan Ajaro Gallery"
    data-amount="<%= total*100 %>"
    data-locale="auto">
    </script>
    <input name= "statut_id" value= 1 type="hidden">
    <input name= "user_id" value= "<%= current_user.id %>" type="hidden">
    <br>
    <br>

    <% end %>

    <% if flash[:success].present? %>
    <div class="alert alert-success" role="alert">
      <%=flash[:success]%>

    </div>
    <% end %>

  </tbody>
</table>

<br>

</div>
